<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /**
         * 环形链表2
         * 
         * 找到环的入口节点
         * 
         * 
         * 
         * 
         */
        function detectCycle(head) {
            if(!head || !head.next) return null;

            let show = head;
            let fast = head;

            while(fast && fast.next) {
                show = show.next;
                fast = fast.next.next;

                if(show === fast) {
                    let index1 = show; // 相遇点
                    let index2 = head; // 头节点

                    while(index1 !== index2) {
                        index1 = index1.next;
                        index2 = index2.next;
                    }

                    return index1
                }
            }
            return null;
        }

        // 测试代码
        // 定义链表节点
        class ListNode {
            constructor(val) {
                this.val = val;
                this.next = null;
            }
        }

        // 构建测试链表 3 -> 2 -> 0 -> -4
        const node1 = new ListNode(3);
        const node2 = new ListNode(2);
        const node3 = new ListNode(0);
        const node4 = new ListNode(-4);

        node1.next = node2;
        node2.next = node3;
        node3.next = node4;

        // 未成环，应该返回 null
        console.log('未成环:', detectCycle(node1)); // null

        // 成环，最后一个节点指向node2
        node4.next = node2;

        // 返回环的入口节点
        const res = detectCycle(node1);
        console.log('成环:', res ? res.val : null); // 2

        // 测试：头结点本身有环 (自己指向自己)
        const solo = new ListNode(99);
        solo.next = solo;
        const res2 = detectCycle(solo);
        console.log('头结点自环:', res2 ? res2.val : null); // 99

        // 测试：无环单节点
        const single = new ListNode(77);
        const res3 = detectCycle(single);
        console.log('无环单节点:', res3 ? res3.val : null); // null

    </script>
</body>
</html>